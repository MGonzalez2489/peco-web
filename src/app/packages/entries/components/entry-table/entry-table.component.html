<div class="flex justify-between my-6">
  <div class="flex gap-5">
    @if (showAccountColumn) {
      <app-select-account
        [showAllOption]="true"
        [(ngModel)]="selectedAccount"
      />
    }
  </div>
  <ng-content></ng-content>
</div>
@if (isDesktopView()) {
  <app-table-placeholder [isLoading]="isBusy()">
    <p-panel>
      <!-- Table -->
      <p-table
        [value]="entries?.data || []"
        [paginator]="false"
        [customSort]="true"
        (onSort)="onSort($event)"
        [sortOrder]="filters?.order === 'ASC' ? 1 : -1"
        [sortField]="filters?.orderBy"
        [lazy]="true"
      >
        <ng-template #header>
          <tr>
            @if (showAccountColumn) {
              <th pSortableColumn="account">
                Cuenta <p-sortIcon field="account" />
              </th>
            }

            <th pSortableColumn="description">
              Descripcion <p-sortIcon field="description" />
            </th>
            <th pSortableColumn="category">
              Categoria <p-sortIcon field="category" />
            </th>
            <th pSortableColumn="type">Tipo <p-sortIcon field="type" /></th>
            <th pSortableColumn="createdAt">
              Creado <p-sortIcon field="createdAt" />
            </th>
            <th pSortableColumn="amount">
              Monto <p-sortIcon field="amount" />
            </th>
          </tr>
        </ng-template>
        <ng-template #body let-entry>
          <tr>
            @if (showAccountColumn) {
              <td>{{ entry.account | titlecase }}</td>
            }

            <td>{{ entry.description | titlecase }}</td>
            <td>{{ entry.category.name }}</td>
            <td>{{ entry.type }}</td>
            <td>{{ entry.createdAt | date: "short" }}</td>
            <td>
              <app-amount
                [amount]="
                  entry.type === 'Gasto' ? entry.amount * -1 : entry.amount
                "
              ></app-amount>
            </td>
          </tr>
        </ng-template>
      </p-table>
      <!-- Pagination -->
      @if (entries) {
        <div class="flex justify-between items-center">
          <div>
            <span class="ms-3 text-gray-500"
              >Pagina {{ entries.meta.page + 1 }} de
              {{ entries.meta.pageCount }}, {{ entries.data.length }} registros
              de {{ entries.meta.itemCount }}</span
            >
          </div>
          <p-paginator
            (onPageChange)="onPageChange($event)"
            [rows]="filters?.take"
            [totalRecords]="entries.meta.itemCount"
            [rowsPerPageOptions]="[5, 10, 25]"
            [first]="entries.meta.take * entries.meta.page"
          />
        </div>
      }
    </p-panel>
  </app-table-placeholder>
} @else {
  <p-panel>
    <p-dataview #dv [value]="entries?.data || []">
      <ng-template #list let-items>
        <div class="">
          @for (item of items; track item.publicId; let first = $first) {
            <div
              class="mb-3 flex items-center gap-3 my-5"
              [ngClass]="{
                'border-t border-gray-400 dark:border-gray-700': !first,
              }"
            >
              <span
                [class]="item.category?.icon"
                style="font-size: 2rem"
              ></span>
              <div class="flex flex-col">
                <span class="font-medium text-secondary text-sm">
                  {{ item.category.name }}
                </span>
                <span
                  class="text-lg font-medium text-gray-900 dark:text-gray-0 mt-2"
                >
                  {{ item.description }}
                </span>
                <span
                  class="text-xl font-semibold text-gray-900 dark:text-gray-0"
                  >{{ "$" + item.amount }}</span
                >
              </div>
            </div>
          }
        </div>
      </ng-template>
    </p-dataview>
  </p-panel>
}
