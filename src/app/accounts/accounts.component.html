<p-card>
  <pre>{{ searchObj | json }}</pre>
  <div class="flex justify-between my-5">
    <!-- Search -->
    <p-inputgroup>
      <input
        pInputText
        placeholder="Keyword"
        [(ngModel)]="searchObj.hint"
        (ngModelChange)="handleSearch()"
      />
      <p-inputgroup-addon>
        <p-button
          variant="text"
          icon="pi pi-times"
          severity="secondary"
          (click)="clearSearch()"
        />
      </p-inputgroup-addon>
    </p-inputgroup>
    <!-- New -->
    <p-button
      icon="pi pi-plus"
      label="Nuevo"
      text="true"
      [routerLink]="['/accounts/new']"
    />
  </div>

  @if (accounts$ | async; as accounts) {
    <p-table
      [value]="accounts.data"
      [paginator]="false"
      stripedRows
      [customSort]="true"
      (onSort)="sort($event)"
      [sortOrder]="searchObj.order === 'ASC' ? 1 : -1"
      [sortField]="searchObj.orderBy"
      [lazy]="true"
    >
      <ng-template #header>
        <tr>
          <th pSortableColumn="name">Cuenta <p-sortIcon field="name" /></th>
          <th pSortableColumn="createdAt">
            Creado <p-sortIcon field="createdAt" />
          </th>
          <th pSortableColumn="balance">
            Balance <p-sortIcon field="balance" />
          </th>
          <th pSortableColumn="isDefault">
            Default <p-sortIcon field="isDefault" />
          </th>
          <th style="width: 5%"></th>
        </tr>
      </ng-template>
      <ng-template #body let-account>
        <tr>
          <td>{{ account.name }}</td>
          <td>{{ account.createdAt | date }}</td>
          <td>
            <p-tag
              [severity]="
                account.balance > 0
                  ? 'success'
                  : account.balance < 0
                    ? 'danger'
                    : 'secondary'
              "
            >
              {{ account.balance | currency }}
            </p-tag>
          </td>
          <td>
            <p-checkbox
              [(ngModel)]="account.isDefault"
              [binary]="true"
              [disabled]="true"
            />
          </td>

          <td>
            <p-button
              icon="pi pi-search"
              [rounded]="true"
              [text]="true"
              severity="secondary"
              variant="outlined"
              [routerLink]="['/accounts', account.publicId]"
            />
          </td>
        </tr>
      </ng-template>
    </p-table>
    <p-paginator
      (onPageChange)="onPageChange($event, accounts.meta)"
      [rows]="searchObj.take"
      [totalRecords]="accounts.meta.itemCount"
      [rowsPerPageOptions]="[5, 10, 25, { showAll: 'All' }]"
      [first]="accounts.meta.take * accounts.meta.page"
    />
  }
</p-card>
